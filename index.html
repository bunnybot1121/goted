<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>The Goted - Neo-Brutalist Dashboard</title>

  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
    rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#FFD028", // Vibrant Yellow
            "primary-dark": "#E6B800",
            secondary: "#FF90E8", // Pink
            accent: "#23F0C7", // Cyan/Mint
            success: "#00E074", // Green
            "accent-pink": "#FF80CA",
            "accent-green": "#00E676",
            "background-light": "#FFFDF5",
            "background-dark": "#121212",
            "neo-pink": "#FF90E8",
            "neo-green": "#B6ECB6",
            "neo-blue": "#AECBEB",
            "neo-yellow": "#FFF59D",
            "neo-purple": "#E0BBE4",
            "card-light": "#ffffff",
            "card-dark": "#2d2d2d",
            "border-dark": "#000000",
            "border-light": "#FFFFFF",
          },
          fontFamily: {
            display: ["Space Grotesk", "sans-serif"],
            mono: ["Space Mono", "monospace"],
          },
          boxShadow: {
            'neo': '4px 4px 0px 0px #000000',
            'neo-sm': '2px 2px 0px 0px #000000',
            'neo-lg': '8px 8px 0px 0px #000000',
            'neo-dark': '4px 4px 0px 0px #ffffff',
            'neo-hover': '6px 6px 0px 0px #000000',
            'neo-active': '2px 2px 0px 0px #000000',
          },
          borderWidth: {
            '3': '3px',
            '4': '4px',
          }
        },
      },
    };
  </script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body {
      background-color: #FFFDF5;
      background-image: radial-gradient(#000 1px, transparent 1px);
      background-size: 40px 40px;
    }

    .dark body {
      background-color: #121212;
      background-image: radial-gradient(#444 1px, transparent 1px);
    }

    .wave-decoration {
      text-decoration: underline;
      text-decoration-style: wavy;
      text-decoration-color: #FF90E8;
      text-underline-offset: 8px;
    }

    /* Custom wave for the main logo to match the screenshot */
    .logo-wave {
      position: relative;
      display: inline-block;
    }

    .logo-wave::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: -10px;
      /* Adjust distance from text */
      width: 100%;
      height: 12px;
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 12"><path d="M0,6 Q5,0 10,6 T20,6" fill="none" stroke="%23FF90E8" stroke-width="3" stroke-linecap="round"/></svg>') repeat-x;
      background-size: 20px 12px;
    }

    /* Chromatic hard shadow for dashboard logo */
    .text-shadow-neo {
      text-shadow:
        2px 0px 0px #23F0C7,
        /* Cyan */
        -2px 0px 0px #FF90E8,
        /* Pink */
        0px 2px 0px #FFD028;
      /* Yellow */
    }
  </style>
</head>

<body
  class="bg-background-light dark:bg-background-dark text-black dark:text-white font-display min-h-screen transition-colors duration-200">

  <!-- LOGIN SCREEN -->
  <div id="login" class="hidden min-h-screen flex flex-col items-center justify-center relative overflow-hidden">
    <div
      class="absolute -top-20 -left-20 w-80 h-80 bg-primary rounded-full border-4 border-black z-0 hidden md:block dark:opacity-80">
    </div>
    <div class="absolute bottom-10 right-10 w-40 h-40 z-0 hidden md:block transform rotate-12">
      <svg class="w-full h-full fill-accent-pink stroke-black stroke-[3px]" viewBox="0 0 100 100">
        <path d="M50 0 L61 35 L98 35 L68 57 L79 91 L50 70 L21 91 L32 57 L2 35 L39 35 Z"></path>
      </svg>
    </div>
    <div
      class="absolute top-10 left-1/2 transform -translate-x-1/2 bg-white dark:bg-card-dark border-4 border-black p-3 rounded-xl shadow-neo rotate-3 z-10 hidden">
      <span class="material-icons text-3xl text-black dark:text-white">psychology</span>
    </div>

    <div class="relative z-10 w-full max-w-sm px-4 mt-2">
      <div class="text-center mb-6 flex flex-col items-center justify-center">
        <!-- Centered Icon Box -->
        <div
          class="bg-white dark:bg-card-dark border-3 border-black rounded-xl w-16 h-16 flex items-center justify-center shadow-neo-sm transform -rotate-3 mb-4 relative z-10">
          <span class="material-icons text-3xl text-black dark:text-white">psychology</span>
          <div class="absolute -right-1.5 -top-1.5 bg-black w-3 h-3 rounded-full"></div>
        </div>

        <!-- Typography -->
        <h1 class="text-5xl font-display font-black tracking-tighter flex items-center justify-center relative z-20">
          <span class="text-black dark:text-white">THE</span><span
            class="text-neo-pink logo-wave ml-1 relative z-20">GOTED</span>
          <span class="text-primary text-3xl absolute -right-9 top-1 animate-pulse">‚ú¶</span>
        </h1>

        <!-- Welcome Badge -->
        <div
          class="inline-flex items-center gap-2 bg-white dark:bg-card-dark border-2 border-black rounded-full px-4 py-1.5 mt-5 shadow-neo-sm">
          <div class="w-3 h-3 bg-accent-green rounded-full border-2 border-black"></div>
          <span class="font-mono text-xs font-bold text-black dark:text-white">Welcome Back!</span>
        </div>
      </div>

      <div class="bg-white dark:bg-card-dark border-3 border-black rounded-2xl shadow-neo p-7 relative">
        <div
          class="flex justify-between items-center mb-4 border-b-2 border-dashed border-black dark:border-gray-500 pb-4">
          <h2 class="text-2xl font-bold text-black dark:text-white">Login</h2>
          <div class="flex gap-1.5">
            <div class="w-3 h-3 rounded-full bg-accent-pink border-2 border-black"></div>
            <div class="w-3 h-3 rounded-full bg-primary border-2 border-black"></div>
            <div class="w-3 h-3 rounded-full bg-accent-green border-2 border-black"></div>
          </div>
        </div>

        <div id="login-error"
          class="hidden bg-red-100 border-2 border-red-500 text-red-700 font-bold p-2 mb-4 rounded shadow-neo-sm font-mono text-xs">
        </div>

        <form class="space-y-6" onsubmit="doLogin(event)">
          <div>
            <label class="block font-mono text-xs font-bold text-black dark:text-gray-200 mb-2 uppercase tracking-wide">
              Email Address
            </label>
            <div class="relative">
              <input id="em"
                class="w-full bg-white dark:bg-gray-800 border-3 border-black rounded-xl px-4 py-3.5 pr-11 text-black dark:text-white font-medium focus:ring-0 focus:border-neo-pink focus:shadow-neo transition-all placeholder-gray-400 dark:placeholder-gray-500 text-sm"
                placeholder="hunter@goted.com" type="email" />
              <div class="absolute inset-y-0 right-0 pr-3.5 flex items-center pointer-events-none">
                <span class="material-icons text-lg text-black dark:text-white">mail</span>
              </div>
            </div>
          </div>

          <div>
            <label class="block font-mono text-xs font-bold text-black dark:text-gray-200 mb-2 uppercase tracking-wide">
              Password
            </label>
            <div class="relative">
              <input id="pw"
                class="w-full bg-white dark:bg-gray-800 border-3 border-black rounded-xl px-4 py-3.5 pr-11 text-black dark:text-white font-medium focus:ring-0 focus:border-neo-pink focus:shadow-neo transition-all placeholder-gray-400 dark:placeholder-gray-500 text-sm"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" type="password" />
              <div class="absolute inset-y-0 right-0 pr-3.5 flex items-center pointer-events-none">
                <span class="material-icons text-lg text-black dark:text-white">lock</span>
              </div>
            </div>
          </div>

          <button id="login-btn"
            class="w-full bg-neo-pink hover:bg-pink-400 text-black font-black text-xl py-5 rounded-2xl border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] hover:shadow-[12px_12px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-2 active:translate-y-2 transition-all flex items-center justify-center gap-3 group uppercase tracking-tight"
            type="submit">
            LET'S GO!
            <img src="icons/rocket.png" alt="rocket"
              class="w-8 h-8 transform group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform inline-block" />
          </button>

          <div class="text-center pt-2">
            <p class="text-[10px] font-mono font-bold text-gray-400 uppercase tracking-widest leading-relaxed">
              Invite-Only Access<br />Verified Members Only
            </p>
          </div>
        </form>
      </div>
    </div>

  </div>

  <!-- MAIN APP DASHBOARD -->
  <div id="app" class="hidden h-screen bg-background-light dark:bg-gray-900 transition-colors duration-200">
    <!-- MASTER SIDEBAR -->
    <aside id="master-sidebar"
      class="fixed left-0 top-0 bottom-0 w-56 border-r-3 border-black dark:border-white bg-white dark:bg-gray-800 z-[60] flex flex-col py-6 px-3 gap-2 shadow-neo-sm overflow-y-auto hide-scrollbar transition-all duration-300 ease-in-out">

      <!-- Logo -->
      <div class="flex items-center gap-2 px-2 mb-4 overflow-hidden">
        <img src="icons/brain.png" alt="brain" class="w-8 h-8 flex-shrink-0" />
        <span
          class="sidebar-label font-display font-black text-lg tracking-tight text-black dark:text-white whitespace-nowrap">THE
          GOTED</span>
      </div>

      <!-- Nav Label -->
      <div class="sidebar-label px-2 mb-1">
        <span class="text-[10px] font-mono font-bold text-gray-400 uppercase tracking-widest">Navigation</span>
      </div>

      <button onclick="switchView('braindump')" title="BrainDump"
        class="nav-icon w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-white shadow-neo-sm hover:shadow-neo hover:-translate-y-0.5 transition-all overflow-hidden">
        <span class="material-icons-outlined font-bold text-black flex-shrink-0" style="font-size: 22px;">bolt</span>
        <span
          class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">BrainDump</span>
      </button>

      <button onclick="switchView('dashboard')" title="Dashboard"
        class="nav-icon w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-primary shadow-neo-lg transition-all overflow-hidden">
        <span class="material-icons-outlined font-bold text-black flex-shrink-0"
          style="font-size: 22px;">dashboard</span>
        <span
          class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">Dashboard</span>
      </button>

      <button onclick="switchView('gallery')" title="Gallery"
        class="nav-icon w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-white shadow-neo-sm hover:shadow-neo hover:-translate-y-0.5 transition-all overflow-hidden">
        <span class="material-icons-outlined font-bold text-black flex-shrink-0"
          style="font-size: 22px;">grid_view</span>
        <span
          class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">Gallery</span>
      </button>

      <button onclick="switchView('calendar')" title="Calendar"
        class="nav-icon w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-white shadow-neo-sm hover:shadow-neo hover:-translate-y-0.5 transition-all overflow-hidden">
        <span class="material-icons-outlined font-bold text-black flex-shrink-0"
          style="font-size: 22px;">calendar_month</span>
        <span
          class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">Calendar</span>
      </button>

      <button onclick="switchView('mindmap')" title="Mind Map"
        class="nav-icon w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-white shadow-neo-sm hover:shadow-neo hover:-translate-y-0.5 transition-all overflow-hidden">
        <span class="material-icons-outlined font-bold text-black flex-shrink-0"
          style="font-size: 22px;">account_tree</span>
        <span class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">Mind
          Map</span>
      </button>

      <button onclick="switchView('flashcards')" title="Flashcards"
        class="nav-icon w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-white shadow-neo-sm hover:shadow-neo hover:-translate-y-0.5 transition-all overflow-hidden">
        <span class="material-icons-outlined font-bold text-black flex-shrink-0" style="font-size: 22px;">school</span>
        <span
          class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">Flashcards</span>
      </button>

      <button onclick="switchView('trash')" title="Trash"
        class="nav-icon w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-white shadow-neo-sm hover:shadow-neo hover:-translate-y-0.5 transition-all overflow-hidden">
        <span class="material-icons-outlined font-bold text-black flex-shrink-0"
          style="font-size: 22px;">delete_outline</span>
        <span class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">Trash</span>
      </button>

      <!-- Bottom Section -->
      <div class="mt-auto flex flex-col gap-2 pt-4 border-t-2 border-dashed border-black/20 dark:border-white/20">
        <button onclick="switchView('collab')"
          class="w-full h-11 flex-shrink-0 flex items-center gap-3 px-3 rounded-xl border-3 border-black bg-white shadow-neo-sm hover:shadow-neo hover:-translate-y-0.5 transition-all overflow-hidden group">
          <span
            class="material-icons-outlined font-bold text-black flex-shrink-0 group-hover:text-neo-pink transition-colors"
            style="font-size: 22px;">groups</span>
          <span
            class="sidebar-label font-bold text-sm text-black uppercase tracking-wide whitespace-nowrap">Collab</span>
        </button>
      </div>
    </aside>

    <!-- CONTENT WRAPPER -->
    <div id="content-wrapper"
      class="flex-1 flex flex-col ml-56 h-screen overflow-hidden relative transition-all duration-300 ease-in-out">
      <nav id="top-nav"
        class="fixed top-0 left-56 right-0 z-50 border-b-3 border-black dark:border-white bg-background-light dark:bg-gray-900 px-4 py-3 flex items-center justify-between transition-all duration-300 ease-in-out">
        <div class="flex items-center gap-2">
          <button
            class="p-2 border-3 border-black dark:border-white rounded-lg hover:shadow-neo dark:hover:shadow-neo-dark transition-all bg-white dark:bg-gray-800"
            onclick="toggleSidebar()">
            <span class="material-icons-outlined text-2xl">menu</span>
          </button>
          <div class="flex items-center ml-4 mr-2">
            <h1
              class="text-3xl font-black tracking-tighter uppercase relative flex items-center group cursor-pointer pt-2 pr-6">
              <span
                class="bg-black text-white px-2 py-0.5 transform -rotate-3 shadow-[3px_3px_0px_#000] inline-block -translate-y-1">THE</span>
              <span class="text-black dark:text-white ml-2 text-shadow-neo tracking-normal inline-block">GOTED</span>
              <svg class="w-6 h-6 absolute right-0 -top-2 fill-primary animate-pulse" viewBox="0 0 100 100">
                <path d="M50 0 L61 35 L98 35 L68 57 L79 91 L50 70 L21 91 L32 57 L2 35 L39 35 Z"></path>
              </svg>
            </h1>
          </div>
        </div>

        <div class="flex-1 max-w-2xl mx-8 hidden md:block">
          <div class="relative group">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <span class="material-icons-outlined text-2xl">search</span>
            </div>
            <input id="search" oninput="doSearch(this.value)"
              class="block w-full pl-10 pr-3 py-3 border-3 border-black dark:border-white rounded-xl leading-5 bg-white dark:bg-gray-800 placeholder-gray-500 focus:outline-none focus:ring-0 focus:shadow-neo dark:focus:shadow-neo-dark transition-all font-bold"
              placeholder="Search raw data..." type="text" />
            <div class="absolute -right-2 -top-2 transform rotate-12 pointer-events-none"><img src="icons/search.png"
                alt="search" class="w-8 h-8" /></div>
          </div>
        </div>

        <div class="flex items-center gap-4">
          <button onclick="openAdd()"
            class="flex items-center gap-2 bg-primary px-6 py-2 rounded-xl border-3 border-black dark:border-white shadow-neo dark:shadow-neo-dark hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all font-bold text-black">
            <span class="material-icons-outlined">add</span>
            ADD
          </button>
          <button onclick="doLogout()"
            class="p-2 flex items-center gap-2 border-3 border-black dark:border-white rounded-lg bg-white dark:bg-gray-800 shadow-neo dark:shadow-neo-dark hover:bg-gray-100 transition-colors">
            <span class="material-icons-outlined">logout</span>
            <span class="font-bold text-sm hidden sm:block">EXIT</span>
          </button>
        </div>
      </nav>

      <!-- VIEW: DASHBOARD -->
      <div id="view-dashboard" class="app-view flex-1 flex flex-col h-full bg-transparent overflow-hidden">
        <main class="pt-24 pb-8 px-4 max-w-[1600px] mx-auto w-full flex-1 flex flex-col overflow-hidden">
          <div class="grid grid-cols-1 md:grid-cols-12 gap-6 h-full flex-1">

            <!-- SIDEBAR FILTERS -->
            <aside class="hidden md:flex md:col-span-2 lg:col-span-2 flex-col gap-4 overflow-y-auto pb-4">
              <div
                class="bg-white dark:bg-gray-800 border-3 border-black dark:border-white rounded-xl p-4 shadow-neo dark:shadow-neo-dark flex-shrink-0">
                <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                  <span class="material-icons-outlined">filter_list</span>
                  Filters
                </h3>
                <div class="flex flex-col gap-3">
                  <button onclick="setFilter('all')"
                    class="flex items-center justify-between w-full p-3 rounded-lg border-3 border-black dark:border-white bg-white dark:bg-gray-700 text-black dark:text-white font-bold shadow-neo-sm hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all data-[active=true]:bg-neo-pink data-[active=true]:text-black"
                    data-cat="all">
                    ALL
                  </button>
                  <button onclick="setFilter('Coding')"
                    class="flex items-center justify-between w-full p-3 rounded-lg border-3 border-black dark:border-white bg-white dark:bg-gray-700 text-black dark:text-white font-bold shadow-neo-sm hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all data-[active=true]:bg-neo-green data-[active=true]:text-black"
                    data-cat="Coding">
                    CODING
                  </button>
                  <button onclick="setFilter('UIUX')"
                    class="flex items-center justify-between w-full p-3 rounded-lg border-3 border-black dark:border-white bg-white dark:bg-gray-700 text-black dark:text-white font-bold shadow-neo-sm hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all data-[active=true]:bg-neo-yellow data-[active=true]:text-black"
                    data-cat="UIUX">
                    UI/UX
                  </button>
                  <button onclick="setFilter('Ideas')"
                    class="flex items-center justify-between w-full p-3 rounded-lg border-3 border-black dark:border-white bg-white dark:bg-gray-700 text-black dark:text-white font-bold shadow-neo-sm hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all data-[active=true]:bg-neo-blue data-[active=true]:text-black"
                    data-cat="Ideas">
                    IDEAS
                  </button>
                  <button onclick="setFilter('Links')"
                    class="flex items-center justify-between w-full p-3 rounded-lg border-3 border-black dark:border-white bg-white dark:bg-gray-700 text-black dark:text-white font-bold shadow-neo-sm hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all data-[active=true]:bg-neo-purple data-[active=true]:text-black"
                    data-cat="Links">
                    LINKS
                  </button>
                </div>
              </div>
            </aside>

            <!-- SAVED MIND MAPS WIDGET (below filters) -->
            <aside class="hidden md:flex md:col-span-2 lg:col-span-2 flex-col gap-4 overflow-y-auto pb-4 -mt-0"
              style="grid-row: 2;">
              <div
                class="bg-white dark:bg-gray-800 border-3 border-black dark:border-white rounded-xl p-4 shadow-neo dark:shadow-neo-dark flex-shrink-0">
                <h3 class="font-bold text-base mb-3 flex items-center gap-2 text-black dark:text-white">
                  <span class="material-icons-outlined text-lg">account_tree</span>
                  Mind Maps
                </h3>
                <div id="dashboard-mindmaps" class="flex flex-col gap-2">
                  <div class="text-[10px] font-mono text-gray-400 text-center py-2">Loading...</div>
                </div>
                <button onclick="switchView('mindmap')"
                  class="w-full mt-3 border-2 border-black dark:border-white rounded-lg py-1.5 text-[10px] font-black uppercase tracking-wider text-black dark:text-white hover:bg-primary hover:shadow-neo-sm transition-all">
                  + New Map
                </button>
              </div>
            </aside>

            <!-- ENTRIES LIST -->
            <section
              class="col-span-1 md:col-span-10 lg:col-span-10 overflow-y-auto pr-2 pb-20 md:pb-0 flex flex-col gap-6"
              id="list-panel">
              <!-- Javascript will inject list items here -->
              <div class="animate-pulse bg-white border-3 border-black rounded-xl p-5 shadow-neo">
                <div class="h-4 bg-gray-200 rounded w-1/4 mb-4 border border-black"></div>
                <div class="h-6 bg-gray-200 rounded w-3/4 mb-4 border border-black"></div>
                <div class="h-20 bg-gray-200 rounded w-full border border-black"></div>
              </div>
            </section>


          </div>
        </main>
      </div>

      <!-- VIEW: GALLERY -->
      <div id="view-gallery" class="app-view hidden flex-col pt-20 pb-8 px-8 overflow-y-auto h-full w-full">
        <div class="flex items-center justify-between mb-6 max-w-7xl mx-auto w-full">
          <h2 class="text-3xl font-bold uppercase tracking-tight flex items-center gap-3 text-black dark:text-white">
            <span class="text-primary material-icons-outlined text-4xl">grid_view</span> Vault Gallery
          </h2>
        </div>
        <div id="gallery-grid"
          class="max-w-7xl mx-auto w-full columns-1 sm:columns-2 md:columns-3 lg:columns-4 gap-6 space-y-6">
        </div>
      </div>

      <!-- VIEW: FLASHCARDS -->
      <div id="view-flashcards"
        class="app-view hidden flex-col items-center justify-center h-full pt-16 px-8 overflow-hidden">
        <!-- Empty State -->
        <div id="flashcard-empty" class="flex flex-col items-center justify-center gap-6">
          <img src="icons/flashcards.png" alt="flashcards" class="w-24 h-24" />
          <h2 class="text-3xl font-bold uppercase text-black dark:text-white">Study Mode</h2>
          <p class="text-sm font-mono text-gray-500 max-w-md text-center">Your vault entries become flashcards. Click
            below to start a randomized study session.</p>
          <button onclick="startStudySession()"
            class="bg-primary text-black border-3 border-black px-8 py-3 font-bold text-lg shadow-neo hover:translate-y-[2px] hover:translate-x-[2px] hover:shadow-neo-sm transition-all rounded-xl uppercase tracking-wider">
            <span class="material-icons-outlined align-middle mr-2">school</span>Start Session
          </button>
        </div>

        <!-- Flashcard -->
        <div id="flashcard" class="hidden w-full max-w-xl cursor-pointer group"
          style="perspective: 1000px; height: 320px;" onclick="this.children[0].classList.toggle('rotate-y-180');">
          <div class="w-full h-full relative transition-transform duration-500" style="transform-style: preserve-3d;">

            <!-- Front Face -->
            <div
              class="absolute inset-0 bg-white dark:bg-gray-800 border-4 border-black dark:border-white rounded-2xl shadow-neo-lg flex flex-col items-center justify-center p-8 text-center"
              style="backface-visibility: hidden;">
              <div class="text-xs font-mono font-bold text-gray-400 uppercase mb-4">FRONT ‚Äî Click to flip</div>
              <div id="fc-front-text" class="text-2xl font-bold text-black dark:text-white"></div>
            </div>

            <!-- Back Face -->
            <div
              class="absolute inset-0 bg-neo-yellow dark:bg-yellow-900 border-4 border-black dark:border-white rounded-2xl shadow-neo-lg flex flex-col items-center p-8 text-center rotate-y-180 overflow-y-auto"
              style="backface-visibility: hidden;">
              <div class="text-xs font-mono font-bold text-black/60 uppercase mb-4 sticky top-0">BACK</div>
              <div id="fc-back-text" class="text-lg font-mono text-black dark:text-white mt-2 whitespace-pre-wrap">
              </div>
            </div>

          </div>
        </div>

        <!-- Progress -->
        <div class="mt-6 w-full max-w-xl">
          <div class="w-full bg-gray-200 border-2 border-black rounded-full h-3 overflow-hidden">
            <div id="fc-progress-bar" class="bg-primary h-full transition-all duration-300 rounded-full"
              style="width: 0%"></div>
          </div>
          <div id="study-progress" class="mt-2 text-center font-mono font-bold text-sm text-black dark:text-gray-300">0
            / 0</div>
        </div>

        <!-- Navigation -->
        <div id="study-actions" class="invisible flex gap-4 mt-4">
          <button
            class="px-6 py-2 border-3 border-black shadow-neo bg-white font-bold text-black rounded-lg hover:shadow-neo-sm hover:translate-x-[2px] hover:translate-y-[2px] transition-all"
            onclick="prevFlashcard()">‚Üê Prev</button>
          <button
            class="px-6 py-2 border-3 border-black shadow-neo bg-neo-pink font-bold text-black rounded-lg hover:shadow-neo-sm hover:translate-x-[2px] hover:translate-y-[2px] transition-all"
            onclick="nextFlashcard(false)">Skip ‚Üí</button>
          <button
            class="px-6 py-2 border-3 border-black shadow-neo bg-success font-bold text-black rounded-lg hover:shadow-neo-sm hover:translate-x-[2px] hover:translate-y-[2px] transition-all"
            onclick="nextFlashcard(true)">Got it! ‚úì</button>
        </div>
      </div>

      <!-- VIEW: BRAINDUMP -->
      <div id="view-braindump"
        class="app-view hidden flex-col items-center justify-center h-full pt-20 px-8 overflow-hidden">
        <h2 class="text-3xl font-bold mb-2 uppercase tracking-widest text-neo-pink wave-decoration">Brain Dump Mode</h2>
        <div id="braindump-sync" class="flex items-center gap-2 mb-6">
          <div class="w-2 h-2 bg-success rounded-full"></div>
          <span class="text-[10px] font-bold uppercase font-mono text-gray-500">Ready</span>
        </div>
        <div class="w-full max-w-3xl relative">
          <textarea id="braindump-input"
            class="w-full h-56 bg-white dark:bg-gray-900 border-4 border-black dark:border-white rounded-2xl shadow-neo-lg p-6 font-mono text-xl focus:outline-none placeholder-gray-400 text-black dark:text-white resize-none"
            placeholder="Each line becomes a separate vault entry..."></textarea>
          <div class="flex items-center justify-between mt-4">
            <div id="braindump-wordcount" class="font-mono text-xs font-bold text-gray-400">0 WORDS</div>
            <button onclick="lockInBrainDump()"
              class="bg-success text-black border-3 border-black px-6 py-2 font-bold shadow-neo hover:translate-y-[2px] hover:translate-x-[2px] hover:shadow-neo-sm transition-all rounded-lg uppercase tracking-wider">
              <span class="material-icons-outlined align-middle mr-1 text-sm">bolt</span>Crystallize
            </button>
          </div>
        </div>
      </div>

      <!-- VIEW: MINDMAP -->
      <div id="view-mindmap" class="app-view hidden flex-col h-full w-full pt-20 relative overflow-hidden">
        <div class="flex items-center justify-between px-8 mb-2">
          <h2 class="text-xl font-bold uppercase tracking-tight flex items-center gap-2 text-black dark:text-white">
            <span class="text-primary material-icons-outlined text-2xl">account_tree</span> Mind Map
          </h2>
          <div id="mindmap-toolbar" class="flex items-center gap-2 flex-wrap">
            <!-- Rendered by renderMindMapToolbar() -->
          </div>
        </div>
        <div class="flex items-center gap-3 px-8 mb-2">
          <div id="mm-saved-list" class="flex items-center gap-2 flex-wrap">
            <span class="text-xs font-mono text-gray-400">No saved maps</span>
          </div>
          <div id="mm-save-status" class="text-xs font-bold text-green-600 opacity-0 transition-opacity"></div>
        </div>
        <div
          class="flex-1 mx-8 mb-2 bg-white dark:bg-gray-900 border-2 border-black dark:border-white rounded-2xl relative overflow-hidden shadow-neo cursor-crosshair"
          id="mindmap-canvas" onclick="handleCanvasClick(event)">
          <svg id="mindmap-svg" class="w-full h-full absolute inset-0"></svg>
          <div id="mindmap-nodes" class="w-full h-full relative">
            <!-- Nodes injected dynamically -->
          </div>
        </div>
        <div class="px-8 mb-2 text-[10px] font-mono text-gray-400">Click shapes to select ‚Ä¢ Drag to move ‚Ä¢ Resize from
          corner ‚Ä¢ Double-click to edit ‚Ä¢ üîó Connect mode to link nodes</div>
      </div>

      <!-- VIEW: CALENDAR -->
      <div id="view-calendar" class="app-view hidden flex-col pt-20 px-8 pb-8 h-full overflow-y-auto">
        <div class="flex items-center justify-between mb-4 max-w-5xl mx-auto w-full">
          <h2 class="text-2xl font-bold uppercase tracking-tight flex items-center gap-3 text-black dark:text-white">
            <span class="text-primary material-icons-outlined text-3xl">calendar_month</span> Activity Map
          </h2>
          <div class="flex items-center gap-3">
            <button onclick="prevMonth()"
              class="bg-white border-2 border-black px-3 py-1 font-bold text-lg shadow-neo-sm hover:shadow-none hover:translate-y-[1px] transition-all rounded-lg">‚Üê</button>
            <div id="cal-month"
              class="text-base font-mono font-bold bg-white dark:bg-card-dark text-black dark:text-white border-2 border-black px-4 py-1.5 rounded-xl shadow-neo-sm min-w-[120px] text-center">
              FEB 2026</div>
            <button onclick="nextMonth()"
              class="bg-white border-2 border-black px-3 py-1 font-bold text-lg shadow-neo-sm hover:shadow-none hover:translate-y-[1px] transition-all rounded-lg">‚Üí</button>
          </div>
        </div>
        <div class="max-w-5xl mx-auto w-full">
          <div id="calendar-grid" class="grid grid-cols-7 gap-1 rounded-2xl overflow-hidden">
            <!-- injected by renderCalendar -->
          </div>
        </div>
        <div id="day-notes-list" class="max-w-5xl mx-auto w-full mt-4 flex flex-col gap-2"></div>
      </div>

      <!-- VIEW: COLLAB -->
      <div id="view-collab" class="app-view hidden pt-24 px-8 overflow-y-auto h-full flex flex-col gap-6 w-full">
        <div class="max-w-7xl w-full mx-auto pb-12">
          <div class="flex items-center justify-between mb-6 border-b-4 border-black dark:border-white pb-4">
            <h2 class="text-3xl font-bold uppercase flex items-center gap-3 text-black dark:text-white">
              <span class="text-neo-pink material-icons-outlined text-4xl">groups</span> Friends &amp; Collab
            </h2>
            <div
              class="flex items-center gap-2 bg-white dark:bg-card-dark border-3 border-black dark:border-white rounded-xl px-4 py-2 shadow-neo-sm">
              <div class="w-3 h-3 bg-success rounded-full animate-pulse border-2 border-black"></div>
              <span class="font-mono text-xs font-bold text-black dark:text-white uppercase">Realtime Active</span>
            </div>
          </div>

          <!-- 3-Column Grid -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 min-h-[calc(100vh-300px)]">

            <!-- Friends Panel -->
            <div
              class="border-4 border-black dark:border-white bg-white dark:bg-gray-800 rounded-2xl shadow-neo-lg flex flex-col overflow-hidden">
              <div class="bg-neo-yellow border-b-4 border-black p-4 flex items-center gap-3">
                <span class="material-icons-outlined text-black font-bold">people</span>
                <h3 class="text-base font-bold text-black uppercase">Friends</h3>
              </div>
              <div id="collab-friends-list" class="flex flex-col gap-3 overflow-y-auto flex-1 p-4">
                <div class="text-center text-gray-400 font-mono text-xs mt-6">Loading friends...</div>
              </div>
            </div>

            <!-- Add Friends + Online Now -->
            <div
              class="border-4 border-black dark:border-white bg-white dark:bg-gray-800 rounded-2xl shadow-neo-lg flex flex-col overflow-hidden">
              <div class="bg-neo-blue border-b-4 border-black p-4 flex items-center gap-3">
                <span class="material-icons-outlined text-black font-bold">person_add</span>
                <h3 class="text-base font-bold text-black uppercase">Add Friends</h3>
              </div>
              <div class="p-4 flex flex-col gap-3 flex-1 overflow-y-auto">
                <!-- Search box -->
                <div class="relative">
                  <span
                    class="material-icons-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-base">search</span>
                  <input id="user-search-input" type="text" placeholder="Search by username..."
                    class="w-full border-3 border-black rounded-xl pl-9 pr-3 py-2.5 text-sm font-bold focus:outline-none focus:shadow-neo bg-white text-black"
                    oninput="searchUsers()" />
                </div>
                <!-- Results -->
                <div id="user-search-results" class="flex flex-col gap-2 overflow-y-auto flex-1">
                  <div class="text-center text-gray-400 font-mono text-xs mt-2">Type to search users...</div>
                </div>
                <div id="collab-users-list" class="hidden"></div>
              </div>
            </div>

            <!-- Panel 2: Incoming Requests -->
            <div
              class="border-4 border-black dark:border-white bg-white dark:bg-gray-800 rounded-2xl shadow-neo-lg flex flex-col overflow-hidden">
              <div class="bg-neo-pink border-b-4 border-black dark:border-white p-4 flex items-center gap-3">
                <span class="material-icons-outlined text-black font-bold">mark_email_unread</span>
                <h3 class="text-base font-bold text-black uppercase">Incoming Requests</h3>
              </div>
              <div id="collab-incoming-list" class="flex flex-col gap-3 overflow-y-auto flex-1 p-4">
                <div class="text-center text-gray-400 font-mono text-xs mt-10">No pending requests</div>
              </div>
            </div>

            <!-- Panel 3: Approved Peeks -->
            <div
              class="border-4 border-black dark:border-white bg-white dark:bg-gray-800 rounded-2xl shadow-neo-lg flex flex-col overflow-hidden">
              <div class="bg-neo-green border-b-4 border-black dark:border-white p-4 flex items-center gap-3">
                <span class="material-icons-outlined text-black font-bold">visibility</span>
                <h3 class="text-base font-bold text-black uppercase">Approved Peeks</h3>
              </div>
              <div id="collab-approved-list" class="flex flex-col gap-3 overflow-y-auto flex-1 p-4">
                <div class="text-center text-gray-400 font-mono text-xs mt-10">No approved access yet</div>
              </div>
            </div>

          </div>

          <!-- Live Feed -->
          <div
            class="mt-6 border-4 border-black dark:border-white bg-background-light dark:bg-gray-900 rounded-2xl shadow-neo-lg flex flex-col overflow-hidden">
            <div class="bg-neo-blue border-b-4 border-black dark:border-white p-4 flex items-center gap-3">
              <span class="material-icons-outlined text-black font-bold">bolt</span>
              <h3 class="text-base font-bold text-black uppercase">Live Updates Feed</h3>
            </div>
            <div id="collab-feed" class="p-6 overflow-y-auto max-h-64 flex flex-col gap-4">
              <div
                class="bg-white border-3 border-black rounded-xl p-4 shadow-neo-sm opacity-50 flex items-center gap-4">
                <div class="bg-gray-200 w-12 h-12 rounded-full border-2 border-black flex items-center justify-center">
                  <span class="material-icons-outlined text-gray-500">history</span>
                </div>
                <div>
                  <div class="font-bold text-sm">Listening for changes...</div>
                  <div class="text-xs font-mono text-gray-500 mt-1">Waiting for database events</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- VIEW: TRASH -->
      <div id="view-trash" class="app-view hidden pt-24 px-8 overflow-y-auto h-full flex flex-col gap-6 w-full">
        <div class="max-w-[1600px] w-full mx-auto grid grid-cols-1 md:grid-cols-2 gap-8 pb-12">
          <div>
            <h2
              class="text-2xl font-bold border-b-4 border-black dark:border-white pb-2 mb-6 uppercase flex items-center gap-2 text-black dark:text-white">
              <span class="text-neo-blue material-icons-outlined">archive</span> Archive
            </h2>
            <div id="archive-grid" class="flex flex-col gap-4"></div>
          </div>
          <div>
            <h2
              class="text-2xl font-bold border-b-4 border-black dark:border-white pb-2 mb-6 uppercase flex items-center gap-2 text-red-500">
              <span class="material-icons-outlined">delete_forever</span> Incinerator
            </h2>
            <div id="trash-grid" class="flex flex-col gap-4"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- QUICK ADD MODAL -->
  <div id="add-overlay"
    class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
    <div
      class="bg-white dark:bg-gray-800 border-4 border-black dark:border-white rounded-2xl p-6 shadow-neo-lg dark:shadow-neo-dark w-full max-w-lg relative transform rotate-1 transition-transform animate-in fade-in zoom-in duration-200">
      <h3 class="text-2xl font-bold mb-4 flex items-center gap-2">
        <span class="text-primary text-3xl">‚ö°</span> Quick Capture
      </h3>

      <div class="space-y-4">
        <input id="m-title" type="text" placeholder="Title"
          class="w-full border-3 border-black dark:border-white rounded-xl p-3 font-bold bg-white dark:bg-gray-900 text-black dark:text-white focus:ring-0 focus:shadow-neo">

        <div class="flex gap-4">
          <select id="m-type"
            class="flex-1 border-3 border-black dark:border-white rounded-xl p-3 font-bold bg-white dark:bg-gray-900 text-black dark:text-white focus:ring-0 focus:shadow-neo appearance-none text-center">
            <option value="note">Note</option>
            <option value="link">Link</option>
            <option value="code">Code</option>
            <option value="idea">Idea</option>
          </select>
          <select id="m-cat"
            class="flex-1 border-3 border-black dark:border-white rounded-xl p-3 font-bold bg-white dark:bg-gray-900 text-black dark:text-white focus:ring-0 focus:shadow-neo appearance-none text-center">
            <option value="">Category</option>
            <option value="Coding">Coding</option>
            <option value="UIUX">UI/UX</option>
            <option value="Ideas">Ideas</option>
            <option value="Links">Links</option>
          </select>
        </div>

        <input id="m-tags" type="text" placeholder="Tags (comma separated)..."
          class="w-full border-3 border-black dark:border-white rounded-xl p-3 font-mono text-sm bg-white dark:bg-gray-900 text-black dark:text-white focus:ring-0 focus:shadow-neo">

        <textarea id="m-content" placeholder="Content..."
          class="w-full h-32 border-3 border-black dark:border-white rounded-xl p-4 font-mono text-sm bg-white dark:bg-gray-900 text-black dark:text-white resize-none focus:ring-0 focus:shadow-neo"></textarea>

        <div class="flex gap-4 mt-2">
          <button onclick="closeAdd()"
            class="flex-1 border-3 border-black dark:border-white rounded-xl py-3 font-bold hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors shadow-neo active:shadow-none active:translate-y-[2px] active:translate-x-[2px]">
            Cancel
          </button>
          <button onclick="submitAdd()"
            class="flex-1 bg-primary text-black border-3 border-black rounded-xl py-3 font-bold hover:bg-primary-dark transition-colors shadow-neo active:shadow-none active:translate-y-[2px] active:translate-x-[2px]">
            Save to Vault
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- DELETE MODAL -->
  <div id="del-overlay"
    class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
    <div
      class="bg-neo-pink border-4 border-black rounded-2xl p-6 shadow-neo-lg w-full max-w-sm text-center transform -rotate-2">
      <h3 class="text-3xl font-bold mb-2 text-black">Delete Item?</h3>
      <p class="font-mono font-bold mb-6 text-black opacity-80">(This cannot be undone)</p>

      <div class="flex gap-4">
        <button onclick="closeDelete()"
          class="flex-1 bg-white border-3 border-black text-black rounded-xl py-3 font-bold hover:bg-gray-100 transition-colors shadow-neo active:shadow-none active:translate-y-[2px] active:translate-x-[2px]">
          Cancel
        </button>
        <button onclick="confirmDelete()"
          class="flex-1 bg-black text-white border-3 border-white rounded-xl py-3 font-bold hover:bg-gray-800 transition-colors shadow-[4px_4px_0px_0px_white] active:shadow-none active:translate-y-[2px] active:translate-x-[2px]">
          DELETE
        </button>
      </div>
    </div>
  </div>
  <!-- VIEW ENTRY MODAL -->
  <div id="view-entry-overlay"
    class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
    <div
      class="bg-white dark:bg-gray-800 border-4 border-black dark:border-white rounded-2xl p-6 shadow-neo-lg dark:shadow-neo-dark w-full max-w-2xl relative transition-transform">
      <div class="absolute -top-4 -right-4">
        <button onclick="closeEntryView()"
          class="w-10 h-10 bg-neo-pink border-3 border-black rounded-full flex items-center justify-center font-bold text-black shadow-neo hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">‚úï</button>
      </div>

      <div class="flex items-center gap-3 mb-4">
        <div id="v-type-badge"
          class="bg-neo-blue border-2 border-black px-2 py-0.5 text-[10px] font-bold uppercase text-black tracking-wider">
          Note</div>
        <div id="v-cat-badge" class="text-xs font-bold text-gray-500 uppercase tracking-wider">Category</div>
      </div>

      <h2 id="v-title"
        class="text-3xl font-bold mb-4 font-display text-black dark:text-white pb-4 border-b-3 border-dashed border-black/20 dark:border-white/20">
        Title</h2>

      <div id="v-tags" class="flex flex-wrap gap-2 mb-6"></div>

      <div
        class="bg-gray-50 dark:bg-gray-900 border-3 border-black dark:border-white p-6 rounded-xl relative overflow-y-auto max-h-[50vh]">
        <div class="absolute top-0 right-0 w-8 h-8 flex flex-wrap">
          <div class="w-4 h-4 bg-black/5"></div>
          <div class="w-4 h-4 bg-transparent"></div>
        </div>
        <pre id="v-content"
          class="font-mono text-sm leading-relaxed whitespace-pre-wrap text-black dark:text-gray-300"></pre>
      </div>

      <div class="mt-6 flex justify-between items-center">
        <div class="text-[10px] font-bold uppercase text-gray-400 font-mono tracking-wider" id="v-date">DATE</div>
        <button onclick="askDelete()"
          class="px-4 py-2 border-3 border-black rounded-xl bg-red-100 font-bold hover:bg-red-200 text-red-600 shadow-neo transition-all active:translate-x-[2px] active:translate-y-[2px] active:shadow-none uppercase tracking-wider text-xs">Delete
          Entry</button>
      </div>
    </div>
  </div>
  <!-- COLLAB VAULT PEEK OVERLAY -->
  <div id="collab-peek-overlay"
    class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-[110] flex items-center justify-center p-4">
    <div
      class="bg-white dark:bg-gray-800 border-4 border-black dark:border-white rounded-2xl shadow-neo-lg w-full max-w-2xl flex flex-col overflow-hidden"
      style="max-height: 85vh">
      <!-- Header -->
      <div class="bg-neo-blue border-b-4 border-black p-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <span class="material-icons-outlined text-black font-bold">visibility</span>
          <h3 id="collab-peek-title" class="text-lg font-bold text-black uppercase">VAULT PEEK</h3>
        </div>
        <button onclick="closeCollabPeek()"
          class="w-9 h-9 bg-neo-pink border-3 border-black rounded-full flex items-center justify-center font-bold text-black shadow-neo-sm hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">‚úï</button>
      </div>
      <!-- Items list -->
      <div id="collab-peek-list" class="overflow-y-auto flex-1 p-6 flex flex-col gap-4">
        <div class="font-mono text-xs text-gray-400 text-center mt-10">Loading...</div>
      </div>
    </div>
  </div>

  <!-- SAVE MAP MODAL -->
  <!-- TOAST NOTIFICATIONS -->
  <div id="toast-container" class="fixed top-6 right-6 z-[200] flex flex-col gap-3 pointer-events-none"
    style="max-width:320px"></div>

  <div id="modal-save-map"
    class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[120] flex items-center justify-center p-4">
    <div
      class="bg-white dark:bg-gray-800 border-4 border-black dark:border-white rounded-2xl p-6 shadow-neo-lg w-full max-w-sm relative transform -rotate-1">
      <!-- Header -->
      <div class="flex items-center gap-3 mb-5">
        <div
          class="w-10 h-10 bg-success border-3 border-black rounded-xl flex items-center justify-center shadow-neo-sm">
          <span class="material-icons-outlined text-black">save</span>
        </div>
        <h3 class="text-xl font-black text-black dark:text-white uppercase tracking-tight">Save Mind Map</h3>
      </div>

      <label class="block font-mono text-xs font-bold text-black dark:text-gray-300 mb-2 uppercase tracking-widest">Map
        Name</label>
      <input id="save-map-name" type="text"
        class="w-full border-3 border-black dark:border-white rounded-xl px-4 py-3 font-bold text-black dark:text-white bg-white dark:bg-gray-900 focus:outline-none focus:shadow-neo transition-all mb-5"
        placeholder="My Mind Map"
        onkeydown="if(event.key==='Enter') confirmSaveMap(); if(event.key==='Escape') closeSaveMapModal();" />

      <div class="flex gap-3">
        <button onclick="closeSaveMapModal()"
          class="flex-1 border-3 border-black dark:border-white rounded-xl py-3 font-bold text-black dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors shadow-neo active:shadow-none active:translate-x-[2px] active:translate-y-[2px]">
          Cancel
        </button>
        <button id="save-map-btn" onclick="confirmSaveMap()"
          class="flex-1 bg-success text-black border-3 border-black rounded-xl py-3 font-bold hover:bg-green-400 transition-colors shadow-neo active:shadow-none active:translate-x-[2px] active:translate-y-[2px] uppercase tracking-wide">
          Save
        </button>
      </div>
    </div>
  </div>

  <!-- FLOATING CHAT PANEL -->
  <div id="chat-panel"
    class="hidden fixed bottom-0 right-6 z-[130] w-80 flex-col border-4 border-black rounded-t-2xl shadow-neo-lg overflow-hidden"
    style="height:480px">
    <!-- Chat header -->
    <div class="bg-neo-blue border-b-4 border-black p-3 flex items-center gap-3 flex-shrink-0">
      <div
        class="w-8 h-8 rounded-full border-2 border-black bg-neo-yellow flex items-center justify-center font-bold text-sm"
        id="chat-avatar">?</div>
      <span id="chat-friend-name" class="font-bold text-black text-sm flex-1 uppercase">Chat</span>
      <button onclick="closeChat()"
        class="w-7 h-7 bg-neo-pink border-2 border-black rounded-full flex items-center justify-center font-bold text-black text-xs hover:scale-110 transition-transform">√ó</button>
    </div>
    <!-- Messages -->
    <div id="chat-messages" class="flex-1 overflow-y-auto p-3 bg-gray-50 dark:bg-gray-900 flex flex-col gap-1">
      <div class="text-center font-mono text-xs text-gray-400 mt-6">No messages yet. Say hi! üëã</div>
    </div>
    <!-- Input -->
    <div class="border-t-3 border-black bg-white dark:bg-gray-800 p-2 flex gap-2 flex-shrink-0">
      <input id="chat-input" type="text" placeholder="Type a message..."
        class="flex-1 border-2 border-black rounded-xl px-3 py-2 text-sm font-bold focus:outline-none focus:shadow-neo bg-white dark:bg-gray-900 text-black dark:text-white"
        onkeydown="chatInputKeydown(event)" />
      <button onclick="sendChatMessage()"
        class="bg-primary border-2 border-black rounded-xl px-3 py-2 font-black text-black shadow-neo-sm hover:shadow-none hover:translate-y-[1px] transition-all">
        <span class="material-icons-outlined text-sm">send</span>
      </button>
    </div>
  </div>

  <!-- SHARE MIND MAP MODAL -->
  <div id="modal-share-map"
    class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[125] flex items-center justify-center p-4">
    <div
      class="bg-white dark:bg-gray-800 border-4 border-black dark:border-white rounded-2xl p-6 shadow-neo-lg w-full max-w-sm">
      <div class="flex items-center gap-3 mb-5">
        <div
          class="w-10 h-10 bg-neo-blue border-3 border-black rounded-xl flex items-center justify-center shadow-neo-sm">
          <span class="material-icons-outlined text-black">share</span>
        </div>
        <div>
          <h3 class="text-lg font-black text-black dark:text-white uppercase">Share Map</h3>
          <div id="share-map-name-display" class="text-xs font-mono text-gray-400"></div>
        </div>
        <button onclick="closeShareMapModal()"
          class="ml-auto w-8 h-8 bg-neo-pink border-2 border-black rounded-full flex items-center justify-center font-bold text-black">√ó</button>
      </div>
      <div class="font-mono text-[10px] font-bold text-gray-400 uppercase mb-3">Choose a friend to share with:</div>
      <div id="share-friends-list" class="flex flex-col gap-2 max-h-60 overflow-y-auto">
        <div class="font-mono text-xs text-gray-400 text-center py-4">Loading...</div>
      </div>
    </div>
  </div>

  <!-- Script references -->
  <script src="app.js"></script>
  <script src="mindmap.js"></script>
</body>

</html>